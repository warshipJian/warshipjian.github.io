(window.webpackJsonp=window.webpackJsonp||[]).push([[73],{424:function(a,t,s){"use strict";s.r(t);var e=s(26),o=Object(e.a)({},(function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"mongodb的介绍与使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mongodb的介绍与使用"}},[a._v("#")]),a._v(" mongodb的介绍与使用")]),a._v(" "),s("p",[a._v("这两天看了下mongoDB权威指南，记录下笔记，相关的细节还是要去看文档。")]),a._v(" "),s("h2",{attrs:{id:"一-mongo的安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一-mongo的安装"}},[a._v("#")]),a._v(" 一.mongo的安装")]),a._v(" "),s("p",[a._v("mongo的安装很简单，新的版本可以直接从官网下载，解压后直接使用。")]),a._v(" "),s("h2",{attrs:{id:"二-启动与连接"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二-启动与连接"}},[a._v("#")]),a._v(" 二.启动与连接")]),a._v(" "),s("p",[a._v("mongo的启动有两种方式：")]),a._v(" "),s("p",[a._v("1.通过配置文件启动")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("logpath=/opt/mongodb/data/mongo_27017/mongod27017.log\nlogappend=true\nfork=true\ndbpath=/opt/mongodb/data/mongo_27017\npidfilepath=/opt/mongodb/data/mongo_27017/mongod_27017.pid\nport=27017\n")])])]),s("p",[a._v("2.启动时指定参数")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("./bin/mongod --port 27017 --fork --logpath /opt/mongodb/data/mongo_27017/mongod27017.log --dbpath /opt/mongodb/data/mongo_27017 --pidfilepath /opt/mongodb/data/mongo_27017/mongod_27017.pid\n")])])]),s("p",[a._v("连接mongo也很简单，比如可以在终端通过mongo命令直接连接，也可以使用如Robo 3T这类的图形化工具")]),a._v(" "),s("p",[a._v("关闭mongo也很简单，直接kill即可，不要kill -9 或pkill。")]),a._v(" "),s("h2",{attrs:{id:"三-mongo的数据库，集合，文档"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#三-mongo的数据库，集合，文档"}},[a._v("#")]),a._v(" 三.mongo的数据库，集合，文档")]),a._v(" "),s("p",[a._v("如果对应mysql来理解的话，类似如下表格")]),a._v(" "),s("table",[s("thead",[s("tr",[s("th",[a._v("RDBMS")]),a._v(" "),s("th",[a._v("MongoDB")])])]),a._v(" "),s("tbody",[s("tr",[s("td",[a._v("Table（表）")]),a._v(" "),s("td",[a._v("Collection（集合）")])]),a._v(" "),s("tr",[s("td",[a._v("Records / Rows（记录/列）")]),a._v(" "),s("td",[a._v("Document / Object（文档/对象）")])])])]),a._v(" "),s("p",[a._v("也就是一个文档类似于mysql的一行数据，多个文档组成的集合类似于mysql的一个表。多个集合就组成一个数据库了。一个mongo实例可以包含多个数据库")]),a._v(" "),s("p",[a._v("文档的格式是json的，如")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('{ site : "w3cschool.cc" }\n')])])]),s("p",[a._v("集合如下面这个列子，它包含了两个文档")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('{"name":"mengxiangyue"} {"Name":"mengxiangyue","sex":"nan"}\n')])])]),s("h2",{attrs:{id:"四-常用命令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#四-常用命令"}},[a._v("#")]),a._v(" 四.常用命令")]),a._v(" "),s("p",[a._v("查看数据库")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("show dbs\n")])])]),s("p",[a._v("使用某个数据库")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("use 数据库名称\n")])])]),s("p",[a._v("查看数据库的集合")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("db.getCollectionInfos()\n")])])]),s("p",[a._v("集合查询")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("db.user.find()\n")])])]),s("p",[a._v("指定条件查询")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('db.user.find({"name":"jack"})\n')])])]),s("p",[a._v("插入")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('db.foo.insert({"bar":"baz"})\n')])])]),s("p",[a._v("insert 插入")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('db.foo.insert({"bar":"baz"})\n')])])]),s("p",[a._v("remove 删除")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('db.users.remove()\ndb.mailing.list.remove({"opt-out":true})\ndb.drop_collection("bar")\n')])])]),s("p",[a._v("update 更新")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('var joe = db.users.findOne({"name":"joe"})\ndb.users.update({"name":"joe"},joe)\n')])])]),s("p",[a._v("排序")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("db.COLLECTION_NAME.find().sort({KEY:1})\n")])])]),s("h2",{attrs:{id:"五-索引"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#五-索引"}},[a._v("#")]),a._v(" 五.索引")]),a._v(" "),s("p",[a._v("创建索引")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("db.COLLECTION_NAME.ensureIndex({KEY:1})\n")])])]),s("p",[a._v("删除索引")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("db.collection.dropIndexes();\ndb.collection.dropIndex({x: 1, y: -1})\n")])])]),s("p",[a._v("重建索引")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("db.myCollection.reIndex()\n// same as:\ndb.runCommand( { reIndex : 'myCollection' } )\n")])])]),s("h2",{attrs:{id:"六-主从，副本集，分片"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#六-主从，副本集，分片"}},[a._v("#")]),a._v(" 六.主从，副本集，分片")]),a._v(" "),s("h3",{attrs:{id:"_1-主从"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-主从"}},[a._v("#")]),a._v(" 1.主从")]),a._v(" "),s("p",[a._v("主从的概念和mysql的一样，可用于备份,故障恢复,读扩展等。如下图")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://img.xiaoxiaoguo.cn/usr/uploads/2017/07/913651181.jpg",alt:"mongo1.jpg"}})]),a._v(" "),s("h3",{attrs:{id:"_2-副本集"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-副本集"}},[a._v("#")]),a._v(" 2.副本集")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("1.集群中没有特定的主数据库。\n2.如果哪个主数据库宕机了，集群中就会推选出一个从属数据库作为主数据库顶上，这就具备了自动故障恢复功能\n")])])]),s("p",[a._v("如图")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://img.xiaoxiaoguo.cn/usr/uploads/2017/07/1717621295.jpg",alt:"mongo2.jpg"}})]),a._v(" "),s("h3",{attrs:{id:"_3-分片"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-分片"}},[a._v("#")]),a._v(" 3.分片")]),a._v(" "),s("p",[a._v("分片就是把一个数据分摊到多个实例上，如图")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://img.xiaoxiaoguo.cn/usr/uploads/2017/07/1717621295.jpg",alt:"mongo3.jpg"}})]),a._v(" "),s("p",[a._v("这部分参考：http://blog.csdn.net/canot/article/details/50739359")])])}),[],!1,null,null,null);t.default=o.exports}}]);