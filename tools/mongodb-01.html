<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>mongodb的介绍与使用 | 小小郭的博客</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="小小郭">
    <link rel="preload" href="/assets/css/0.styles.f333096b.css" as="style"><link rel="preload" href="/assets/js/app.158714e6.js" as="script"><link rel="preload" href="/assets/js/2.a806d99a.js" as="script"><link rel="preload" href="/assets/js/73.94ae8b58.js" as="script"><link rel="prefetch" href="/assets/js/10.ceb6da30.js"><link rel="prefetch" href="/assets/js/11.f6fcdde7.js"><link rel="prefetch" href="/assets/js/12.c1ccc7c5.js"><link rel="prefetch" href="/assets/js/13.2e80b5f4.js"><link rel="prefetch" href="/assets/js/14.86580eea.js"><link rel="prefetch" href="/assets/js/15.ec8bc9ac.js"><link rel="prefetch" href="/assets/js/16.ffe6c259.js"><link rel="prefetch" href="/assets/js/17.f11cefb5.js"><link rel="prefetch" href="/assets/js/18.ba7fa50a.js"><link rel="prefetch" href="/assets/js/19.d98194cd.js"><link rel="prefetch" href="/assets/js/20.b3e3e3ba.js"><link rel="prefetch" href="/assets/js/21.0560925d.js"><link rel="prefetch" href="/assets/js/22.151f504b.js"><link rel="prefetch" href="/assets/js/23.c0dd585a.js"><link rel="prefetch" href="/assets/js/24.5ac8c4b5.js"><link rel="prefetch" href="/assets/js/25.57989e7c.js"><link rel="prefetch" href="/assets/js/26.19ae4c70.js"><link rel="prefetch" href="/assets/js/27.7b7a4013.js"><link rel="prefetch" href="/assets/js/28.c02de8fb.js"><link rel="prefetch" href="/assets/js/29.be98b5ac.js"><link rel="prefetch" href="/assets/js/3.f9a5341d.js"><link rel="prefetch" href="/assets/js/30.151ce4ad.js"><link rel="prefetch" href="/assets/js/31.e3b05220.js"><link rel="prefetch" href="/assets/js/32.48233f51.js"><link rel="prefetch" href="/assets/js/33.cdf1ba85.js"><link rel="prefetch" href="/assets/js/34.8e175bdf.js"><link rel="prefetch" href="/assets/js/35.53e76add.js"><link rel="prefetch" href="/assets/js/36.2588db5d.js"><link rel="prefetch" href="/assets/js/37.904d3476.js"><link rel="prefetch" href="/assets/js/38.1424f189.js"><link rel="prefetch" href="/assets/js/39.0e05003b.js"><link rel="prefetch" href="/assets/js/4.84d9a9b8.js"><link rel="prefetch" href="/assets/js/40.e4b36098.js"><link rel="prefetch" href="/assets/js/41.13258ed7.js"><link rel="prefetch" href="/assets/js/42.6f5a7cbb.js"><link rel="prefetch" href="/assets/js/43.7898149d.js"><link rel="prefetch" href="/assets/js/44.37b08732.js"><link rel="prefetch" href="/assets/js/45.17998593.js"><link rel="prefetch" href="/assets/js/46.055bc79a.js"><link rel="prefetch" href="/assets/js/47.6df10fa7.js"><link rel="prefetch" href="/assets/js/48.2660180a.js"><link rel="prefetch" href="/assets/js/49.4625a12a.js"><link rel="prefetch" href="/assets/js/5.501f4465.js"><link rel="prefetch" href="/assets/js/50.b3b348da.js"><link rel="prefetch" href="/assets/js/51.dcb3be6c.js"><link rel="prefetch" href="/assets/js/52.7dd04b5b.js"><link rel="prefetch" href="/assets/js/53.20259b4b.js"><link rel="prefetch" href="/assets/js/54.c876d67f.js"><link rel="prefetch" href="/assets/js/55.52c8359c.js"><link rel="prefetch" href="/assets/js/56.ab71b89a.js"><link rel="prefetch" href="/assets/js/57.30af5fe9.js"><link rel="prefetch" href="/assets/js/58.d1f3acb8.js"><link rel="prefetch" href="/assets/js/59.0c65a864.js"><link rel="prefetch" href="/assets/js/6.56baaf4e.js"><link rel="prefetch" href="/assets/js/60.cc2dc3eb.js"><link rel="prefetch" href="/assets/js/61.bc3d577e.js"><link rel="prefetch" href="/assets/js/62.88dedbc6.js"><link rel="prefetch" href="/assets/js/63.5403d296.js"><link rel="prefetch" href="/assets/js/64.cdcabf93.js"><link rel="prefetch" href="/assets/js/65.7fba108e.js"><link rel="prefetch" href="/assets/js/66.51641258.js"><link rel="prefetch" href="/assets/js/67.f408a0b2.js"><link rel="prefetch" href="/assets/js/68.326016eb.js"><link rel="prefetch" href="/assets/js/69.9dde49ee.js"><link rel="prefetch" href="/assets/js/7.86ee5bb7.js"><link rel="prefetch" href="/assets/js/70.76be6feb.js"><link rel="prefetch" href="/assets/js/71.8bb3d5a3.js"><link rel="prefetch" href="/assets/js/72.3d340b56.js"><link rel="prefetch" href="/assets/js/74.c38b2bf5.js"><link rel="prefetch" href="/assets/js/75.ab88131c.js"><link rel="prefetch" href="/assets/js/76.b15fc67e.js"><link rel="prefetch" href="/assets/js/8.77896323.js"><link rel="prefetch" href="/assets/js/9.1bb7c316.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f333096b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="global-layout"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">小小郭的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/about/index.html" class="nav-link">
  关于我
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/about/index.html" class="nav-link">
  关于我
</a></div> <!----></nav>  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="mongodb的介绍与使用"><a href="#mongodb的介绍与使用" class="header-anchor">#</a> mongodb的介绍与使用</h1> <p>这两天看了下mongoDB权威指南，记录下笔记，相关的细节还是要去看文档。</p> <h2 id="一-mongo的安装"><a href="#一-mongo的安装" class="header-anchor">#</a> 一.mongo的安装</h2> <p>mongo的安装很简单，新的版本可以直接从官网下载，解压后直接使用。</p> <h2 id="二-启动与连接"><a href="#二-启动与连接" class="header-anchor">#</a> 二.启动与连接</h2> <p>mongo的启动有两种方式：</p> <p>1.通过配置文件启动</p> <div class="language- extra-class"><pre class="language-text"><code>logpath=/opt/mongodb/data/mongo_27017/mongod27017.log
logappend=true
fork=true
dbpath=/opt/mongodb/data/mongo_27017
pidfilepath=/opt/mongodb/data/mongo_27017/mongod_27017.pid
port=27017
</code></pre></div><p>2.启动时指定参数</p> <div class="language- extra-class"><pre class="language-text"><code>./bin/mongod --port 27017 --fork --logpath /opt/mongodb/data/mongo_27017/mongod27017.log --dbpath /opt/mongodb/data/mongo_27017 --pidfilepath /opt/mongodb/data/mongo_27017/mongod_27017.pid
</code></pre></div><p>连接mongo也很简单，比如可以在终端通过mongo命令直接连接，也可以使用如Robo 3T这类的图形化工具</p> <p>关闭mongo也很简单，直接kill即可，不要kill -9 或pkill。</p> <h2 id="三-mongo的数据库，集合，文档"><a href="#三-mongo的数据库，集合，文档" class="header-anchor">#</a> 三.mongo的数据库，集合，文档</h2> <p>如果对应mysql来理解的话，类似如下表格</p> <table><thead><tr><th>RDBMS</th> <th>MongoDB</th></tr></thead> <tbody><tr><td>Table（表）</td> <td>Collection（集合）</td></tr> <tr><td>Records / Rows（记录/列）</td> <td>Document / Object（文档/对象）</td></tr></tbody></table> <p>也就是一个文档类似于mysql的一行数据，多个文档组成的集合类似于mysql的一个表。多个集合就组成一个数据库了。一个mongo实例可以包含多个数据库</p> <p>文档的格式是json的，如</p> <div class="language- extra-class"><pre class="language-text"><code>{ site : &quot;w3cschool.cc&quot; }
</code></pre></div><p>集合如下面这个列子，它包含了两个文档</p> <div class="language- extra-class"><pre class="language-text"><code>{&quot;name&quot;:&quot;mengxiangyue&quot;} {&quot;Name&quot;:&quot;mengxiangyue&quot;,&quot;sex&quot;:&quot;nan&quot;}
</code></pre></div><h2 id="四-常用命令"><a href="#四-常用命令" class="header-anchor">#</a> 四.常用命令</h2> <p>查看数据库</p> <div class="language- extra-class"><pre class="language-text"><code>show dbs
</code></pre></div><p>使用某个数据库</p> <div class="language- extra-class"><pre class="language-text"><code>use 数据库名称
</code></pre></div><p>查看数据库的集合</p> <div class="language- extra-class"><pre class="language-text"><code>db.getCollectionInfos()
</code></pre></div><p>集合查询</p> <div class="language- extra-class"><pre class="language-text"><code>db.user.find()
</code></pre></div><p>指定条件查询</p> <div class="language- extra-class"><pre class="language-text"><code>db.user.find({&quot;name&quot;:&quot;jack&quot;})
</code></pre></div><p>插入</p> <div class="language- extra-class"><pre class="language-text"><code>db.foo.insert({&quot;bar&quot;:&quot;baz&quot;})
</code></pre></div><p>insert 插入</p> <div class="language- extra-class"><pre class="language-text"><code>db.foo.insert({&quot;bar&quot;:&quot;baz&quot;})
</code></pre></div><p>remove 删除</p> <div class="language- extra-class"><pre class="language-text"><code>db.users.remove()
db.mailing.list.remove({&quot;opt-out&quot;:true})
db.drop_collection(&quot;bar&quot;)
</code></pre></div><p>update 更新</p> <div class="language- extra-class"><pre class="language-text"><code>var joe = db.users.findOne({&quot;name&quot;:&quot;joe&quot;})
db.users.update({&quot;name&quot;:&quot;joe&quot;},joe)
</code></pre></div><p>排序</p> <div class="language- extra-class"><pre class="language-text"><code>db.COLLECTION_NAME.find().sort({KEY:1})
</code></pre></div><h2 id="五-索引"><a href="#五-索引" class="header-anchor">#</a> 五.索引</h2> <p>创建索引</p> <div class="language- extra-class"><pre class="language-text"><code>db.COLLECTION_NAME.ensureIndex({KEY:1})
</code></pre></div><p>删除索引</p> <div class="language- extra-class"><pre class="language-text"><code>db.collection.dropIndexes();
db.collection.dropIndex({x: 1, y: -1})
</code></pre></div><p>重建索引</p> <div class="language- extra-class"><pre class="language-text"><code>db.myCollection.reIndex()
// same as:
db.runCommand( { reIndex : 'myCollection' } )
</code></pre></div><h2 id="六-主从，副本集，分片"><a href="#六-主从，副本集，分片" class="header-anchor">#</a> 六.主从，副本集，分片</h2> <h3 id="_1-主从"><a href="#_1-主从" class="header-anchor">#</a> 1.主从</h3> <p>主从的概念和mysql的一样，可用于备份,故障恢复,读扩展等。如下图</p> <p><img src="https://img.xiaoxiaoguo.cn/usr/uploads/2017/07/913651181.jpg" alt="mongo1.jpg"></p> <h3 id="_2-副本集"><a href="#_2-副本集" class="header-anchor">#</a> 2.副本集</h3> <div class="language- extra-class"><pre class="language-text"><code>1.集群中没有特定的主数据库。
2.如果哪个主数据库宕机了，集群中就会推选出一个从属数据库作为主数据库顶上，这就具备了自动故障恢复功能
</code></pre></div><p>如图</p> <p><img src="https://img.xiaoxiaoguo.cn/usr/uploads/2017/07/1717621295.jpg" alt="mongo2.jpg"></p> <h3 id="_3-分片"><a href="#_3-分片" class="header-anchor">#</a> 3.分片</h3> <p>分片就是把一个数据分摊到多个实例上，如图</p> <p><img src="https://img.xiaoxiaoguo.cn/usr/uploads/2017/07/1717621295.jpg" alt="mongo3.jpg"></p> <p>这部分参考：http://blog.csdn.net/canot/article/details/50739359</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div> <footer><div style="text-align: center;">
            © 2020 小小郭的博客
            <a href="http://www.beian.miit.gov.cn/">粤ICP备16016910号</a> <br><br></div></footer></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.158714e6.js" defer></script><script src="/assets/js/2.a806d99a.js" defer></script><script src="/assets/js/73.94ae8b58.js" defer></script>
  </body>
</html>
