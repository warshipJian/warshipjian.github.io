(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{405:function(a,e,s){"use strict";s.r(e);var t=s(26),n=Object(t.a)({},(function(){var a=this,e=a.$createElement,s=a._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"redis-01-常用操作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#redis-01-常用操作"}},[a._v("#")]),a._v(" redis-01-常用操作")]),a._v(" "),s("p",[a._v("如今是8102年了，作为一个老牌的缓存数据库redis，依然非常强劲。准备把它系统地过一遍，计划分两部分来进行：")]),a._v(" "),s("p",[a._v("1.redis使用")]),a._v(" "),s("p",[a._v("2.redis原理分析")]),a._v(" "),s("h2",{attrs:{id:"redis通识"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#redis通识"}},[a._v("#")]),a._v(" redis通识")]),a._v(" "),s("p",[s("strong",[a._v("命令")])]),a._v(" "),s("p",[a._v("这些是通用命令，对所有redis的数据结构都可以操作")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("expire 设置过期时间\ndel 删除键值\n")])])]),s("p",[s("strong",[a._v("操作结果")])]),a._v(" "),s("p",[a._v("正常操作返回OK 或 (integer) 加数字")]),a._v(" "),s("p",[a._v("更新操作返回(integer) 0")]),a._v(" "),s("p",[a._v("空值是 (nil)")]),a._v(" "),s("h2",{attrs:{id:"redis的数据结构"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#redis的数据结构"}},[a._v("#")]),a._v(" redis的数据结构")]),a._v(" "),s("p",[a._v("Redis 有 5 种常用的基础数据结构，分别为：string (字符串)、list (列表)、set (集合)、hash (哈希) 和 zset (有序集合)")]),a._v(" "),s("p",[a._v("除了这5种还有bitmap，hyperloglog等，本次只介绍这5种。")]),a._v(" "),s("p",[a._v("Redis 所有的数据结构都是以唯一的 key 字符串作为名称，然后通过这个唯一 key 值来获取相应的 value 数据。不同类型的数据结构的差异就在于 value 的结构不一样。")]),a._v(" "),s("h2",{attrs:{id:"字符串"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#字符串"}},[a._v("#")]),a._v(" 字符串")]),a._v(" "),s("p",[s("strong",[a._v("设置键值对")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("127.0.0.1:6379> set name1 boy\nOK\n")])])]),s("p",[s("strong",[a._v("获取该键值")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('127.0.0.1:6379> get name1\n"boy"\n')])])]),s("p",[s("strong",[a._v("批量设置")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("127.0.0.1:6379> mset name1 boy name2 girl name3 none\nOK\n")])])]),s("p",[s("strong",[a._v("批量获取")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('127.0.0.1:6379> mget name1 name2 name3\n1) "boy"\n2) "girl"\n3) "none"\n')])])]),s("p",[s("strong",[a._v("设置过期时间")])]),a._v(" "),s("p",[a._v("用set + codehole")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("127.0.0.1:6379> SETEX name1 2 codehole  #设置2秒过期\nOK\n127.0.0.1:6379> get name1  #2秒后该键值消失\n(nil)\n")])])]),s("p",[a._v("用expire")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("127.0.0.1:6379> expire name2 2\n(integer) 1\n127.0.0.1:6379> get name2\n(nil)\n")])])]),s("p",[s("strong",[a._v("计数")]),a._v("\n如果 value 值是一个整数，还可以对它进行自增操作。")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('127.0.0.1:6379> set val 27\nOK\n127.0.0.1:6379> get val\n"27"\n127.0.0.1:6379> INCR val  #自增1\n(integer) 28\n127.0.0.1:6379> get val\n"28"\n127.0.0.1:6379> INCRBY val 5 #加5\n(integer) 33\n127.0.0.1:6379> get val\n"33"\n127.0.0.1:6379> INCRBY val -3 #减3\n(integer) 30\n127.0.0.1:6379> get val\n"30"\n')])])]),s("h2",{attrs:{id:"列表"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#列表"}},[a._v("#")]),a._v(" 列表")]),a._v(" "),s("p",[a._v("可以理解为数据结构中的双向链表，常用于队列。")]),a._v(" "),s("p",[s("strong",[a._v("向列表中添加元素(右边进)")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("127.0.0.1:6379> rpush books python php golang c #右边进\n(integer) 4\n#lpush是左边进，后面的例子都是右边进的\n")])])]),s("p",[s("strong",[a._v("查看该列表长度")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("127.0.0.1:6379> llen books\n(integer) 4\n")])])]),s("p",[s("strong",[a._v("查看该列表的元素")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('127.0.0.1:6379> lrange books 0 3\n1) "python"\n2) "php"\n3) "golang"\n4) "c"\n')])])]),s("p",[s("strong",[a._v("查看该列表的所有元素")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('127.0.0.1:6379> lrange books 0 -1\n1) "python"\n2) "php"\n3) "golang"\n4) "c"\n')])])]),s("p",[s("strong",[a._v("右边进左边出(先进先出)：队列")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('127.0.0.1:6379> lpop books\n"python"\n127.0.0.1:6379> lrange books 0 3\n1) "php"\n2) "golang"\n3) "c"\n')])])]),s("p",[s("strong",[a._v("右边进右边出(先进后出)：栈")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('127.0.0.1:6379> rpop books\n"c"\n127.0.0.1:6379> lrange books 0 3\n1) "php"\n2) "golang"\n')])])]),s("p",[a._v("当列表弹出了最后一个元素之后，该数据结构自动被删除，内存被回收。")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('127.0.0.1:6379> rpop books\n"golang"\n127.0.0.1:6379> rpop books\n"php"\n127.0.0.1:6379> lrange books 0 3\n(empty list or set)\n')])])]),s("p",[s("strong",[a._v("lindex索引")])]),a._v(" "),s("p",[a._v("慎用")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('127.0.0.1:6379> rpush books python php golang c\n(integer) 4\n127.0.0.1:6379> lindex books 2 #正方向\n"golang"\n127.0.0.1:6379> lindex books -3 #反方向\n"php"\n')])])]),s("p",[s("strong",[a._v("ltrim保留范围内的值")])]),a._v(" "),s("p",[a._v("慎用")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('127.0.0.1:6379> ltrim books 1 2 #保留范围是1到2的值\nOK\n127.0.0.1:6379> lrange books 0 3\n1) "php"\n2) "golang"\n')])])]),s("h2",{attrs:{id:"hash"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#hash"}},[a._v("#")]),a._v(" Hash")]),a._v(" "),s("p",[s("strong",[a._v("创建一个Hash")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('127.0.0.1:6379> hset books golang "hello golang"\n(integer) 1\n127.0.0.1:6379> hset books php "hello php"\n(integer) 1\n127.0.0.1:6379> hset books python "hello python"\n(integer) 1\n127.0.0.1:6379> hset books c "hello c"\n(integer) 1\n')])])]),s("p",[s("strong",[a._v("获取该Hash的所有元素")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('127.0.0.1:6379> hgetall books\n1) "golang"\n2) "hello golang"\n3) "php"\n4) "hello php"\n5) "python"\n6) "hello python"\n7) "c"\n8) "hello c"\n')])])]),s("p",[s("strong",[a._v("获取指定key的元素")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('127.0.0.1:6379> hget books golang\n"hello golang"\n')])])]),s("p",[s("strong",[a._v("更新指定的key")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('127.0.0.1:6379> hset books golang "hi golang"\n(integer) 0\n127.0.0.1:6379> hget books golang\n"hi golang"\n')])])]),s("p",[s("strong",[a._v("设置多个")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('127.0.0.1:6379> hmset books java "hi java" js "hi js"\nOK\n')])])]),s("p",[s("strong",[a._v("计数")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('127.0.0.1:6379> hset books page 100\n(integer) 1\n127.0.0.1:6379> HINCRBY books page 1\n(integer) 101\n127.0.0.1:6379> hget books page\n"101"\n')])])]),s("h2",{attrs:{id:"集合"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#集合"}},[a._v("#")]),a._v(" 集合")]),a._v(" "),s("p",[a._v("集合内的键值对是唯一无序的，它和列表的区别是：列表是序的，可重复的。")]),a._v(" "),s("p",[s("strong",[a._v("添加一个元素")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('127.0.0.1:6379> sadd books python\n(integer) 1\n127.0.0.1:6379> smembers books #查看值\n1) "python"\n127.0.0.1:6379> sadd books python #重复添加\n(integer) 0\n127.0.0.1:6379> smembers books #还是只有一个\n1) "python"\n127.0.0.1:6379>\n')])])]),s("p",[s("strong",[a._v("检查某个值是否存在")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("127.0.0.1:6379> sismember books abc #不存在abc\n(integer) 0\n127.0.0.1:6379> sismember books python #python存在\n(integer) 1\n")])])]),s("p",[s("strong",[a._v("获取长度")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("127.0.0.1:6379> sadd books php\n(integer) 1\n127.0.0.1:6379> scard books\n(integer) 1\n127.0.0.1:6379> sadd books go\n(integer) 1\n127.0.0.1:6379> scard books\n(integer) 2\n")])])]),s("p",[s("strong",[a._v("弹出")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('127.0.0.1:6379> sadd books python php go\n(integer) 1\n127.0.0.1:6379> spop books    #弹出一个\n"python"\n127.0.0.1:6379> smembers books\n1) "php"\n2) "go"\n')])])]),s("h2",{attrs:{id:"有序集"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#有序集"}},[a._v("#")]),a._v(" 有序集")]),a._v(" "),s("p",[a._v("可以理解为加强型的集合，它可以对value设置一个score，用来排序")]),a._v(" "),s("p",[s("strong",[a._v("添加元素")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("127.0.0.1:6379> zadd user 98 xiaohong #添加个用户xiaohong，值是98\n(integer) 1\n127.0.0.1:6379> zadd user 99 xiaoming \n(integer) 1\n127.0.0.1:6379> zadd user 97 xiaoli\n(integer) 1\n127.0.0.1:6379> zadd user 98 xiaogang\n(integer) 1\n")])])]),s("p",[s("strong",[a._v("正序")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('127.0.0.1:6379> zrange user 0 -1\n1) "xiaoli"\n2) "xiaogang"\n3) "xiaohong"\n4) "xiaoming"\n')])])]),s("p",[s("strong",[a._v("倒序")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('127.0.0.1:6379> zrevrange user 0 -1\n1) "xiaoming"\n2) "xiaohong"\n3) "xiaogang"\n4) "xiaoli"\n')])])]),s("p",[s("strong",[a._v("获取score")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('127.0.0.1:6379>  zscore user xiaohong\n"98"\n')])])]),s("p",[s("strong",[a._v("查看长度")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("127.0.0.1:6379> zcard  user\n(integer) 4\n")])])]),s("p",[s("strong",[a._v("查看正序的排名")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("127.0.0.1:6379> zrank user xiaohong\n(integer) 2\n127.0.0.1:6379> zrank user xiaoli\n(integer) 0\n")])])]),s("p",[s("strong",[a._v("查看倒序的排名")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("127.0.0.1:6379> zrevrank user xiaohong\n(integer) 1\n127.0.0.1:6379> zrevrank user xiaoli\n(integer) 3\n")])])]),s("p",[s("strong",[a._v("查看某个范围的value")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('127.0.0.1:6379> zrangebyscore user 98 99\n1) "xiaogang"\n2) "xiaohong"\n3) "xiaoming"\n')])])]),s("p",[s("strong",[a._v("查看某个范围的value并返回对应的score")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('127.0.0.1:6379> zrangebyscore user 98 99  withscores\n1) "xiaogang"\n2) "98"\n3) "xiaohong"\n4) "98"\n5) "xiaoming"\n6) "99"\n')])])]),s("p",[s("strong",[a._v("删除某个value")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("127.0.0.1:6379> zrem user xiaogang\n(integer) 1\n")])])]),s("h2",{attrs:{id:"注"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#注"}},[a._v("#")]),a._v(" 注")]),a._v(" "),s("p",[a._v("我在学习的过程中参考的是"),s("a",{attrs:{href:"https://juejin.im/book/5afc2e5f6fb9a07a9b362527/section/5b336601f265da598e13f917",target:"_blank",rel:"noopener noreferrer"}},[a._v("Redis 深度历险：核心原理与应用实践"),s("OutboundLink")],1),a._v("，有兴趣的可以去读下。")])])}),[],!1,null,null,null);e.default=n.exports}}]);