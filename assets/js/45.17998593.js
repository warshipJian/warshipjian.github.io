(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{396:function(t,s,a){"use strict";a.r(s);var e=a(26),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"在laravel中集成swagger"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在laravel中集成swagger"}},[t._v("#")]),t._v(" 在laravel中集成swagger")]),t._v(" "),a("p",[t._v("swagger是非常好用的一个API文档工具，大大地减轻了前端和后端的沟通成本。在写后端接口的时候，也可以用它来测试接口，非常方便。\n整个过程如下。")]),t._v(" "),a("h4",{attrs:{id:"新建一个laravel项目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#新建一个laravel项目"}},[t._v("#")]),t._v(" 新建一个laravel项目")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("composer create-project --prefer-dist laravel/laravel Blog\n")])])]),a("h4",{attrs:{id:"获取darkaonline-l5-swagger"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取darkaonline-l5-swagger"}},[t._v("#")]),t._v(" 获取darkaonline/l5-swagger")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('composer require "darkaonline/l5-swagger"\n')])])]),a("h4",{attrs:{id:"注册组件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#注册组件"}},[t._v("#")]),t._v(" 注册组件")]),t._v(" "),a("p",[t._v("在config/app.php的providers中添加\\L5Swagger\\L5SwaggerServiceProvider::class,")]),t._v(" "),a("h4",{attrs:{id:"创建swagger-ui等"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建swagger-ui等"}},[t._v("#")]),t._v(" 创建swagger-UI等")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("php artisan l5-swagger:publish\n")])])]),a("h4",{attrs:{id:"创建swagger配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建swagger配置文件"}},[t._v("#")]),t._v(" 创建swagger配置文件")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("php artisan l5-swagger:publish-config \n")])])]),a("p",[t._v("执行该命令后，会在config目录下产生一个l5-swagger.php的配置文件，里面包含了swagger标题，token验证，路由等。")]),t._v(" "),a("p",[t._v("其中'generate_always'配置可以根据需要修改下，它表示是否每次都刷新swagger。如果是关闭，则修改swagger配置后，要使用"),a("strong",[t._v("php artisan l5-swagger:generate")]),t._v("命令手动刷新。")]),t._v(" "),a("h4",{attrs:{id:"访问测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#访问测试"}},[t._v("#")]),t._v(" 访问测试")]),t._v(" "),a("p",[t._v("在浏览器访问http://127.0.0.1/api/documentation,可以看到swagger的界面了，但会提示缺少api-docs.json文件。")]),t._v(" "),a("p",[t._v("可以在app下创建个php文件，如swagger.php，内容如下")]),t._v(" "),a("div",{staticClass:"language-php extra-class"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token php language-php"}},[a("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("<?php")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('/**\n * Class Controller\n *\n * @package App\\Http\\Controllers\n *\n * @SWG\\Swagger(\n *     basePath="",\n *     host="127.0.0.1",\n *     schemes={"http"},\n *     @SWG\\Info(\n *         version="1.0",\n *         title="OpenApi",\n *         @SWG\\Contact(name="Pek Ratanak", url="https://www.google.com"),\n *     ),\n *     @SWG\\Definition(\n *         definition="Error",\n *         required={"code", "message"},\n *         @SWG\\Property(\n *             property="code",\n *             type="integer",\n *             format="int32"\n *         ),\n *         @SWG\\Property(\n *             property="message",\n *             type="string"\n *         )\n *     )\n * )\n */')]),t._v("\n")])])])]),a("p",[t._v("刷新下swagger，重新访问")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("php artisan l5-swagger:generate\n")])])]),a("h4",{attrs:{id:"添加测试api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加测试api"}},[t._v("#")]),t._v(" 添加测试API")]),t._v(" "),a("p",[t._v("比如创建一个test的TestController")]),t._v(" "),a("p",[t._v("php artisan make:controller TestController")]),t._v(" "),a("p",[t._v("内容如下")]),t._v(" "),a("div",{staticClass:"language-php extra-class"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token php language-php"}},[a("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("<?php")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("namespace")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token package"}},[t._v("App"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Controllers")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token package"}},[t._v("Illuminate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Request")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TestController")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Controller")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('/**\n     * @SWG\\Get(\n     *     path="/api/test",\n     *     description="返回测试内容",\n     *     operationId="api.dashboard.index",\n     *     produces={"application/json"},\n     *     tags={"测试"},\n     *     @SWG\\Parameter(\n     *         in="formData",\n     *         name="reason",\n     *         type="string",\n     *         description="拿数据的理由",\n     *         required=true,\n     *     ),\n     *     @SWG\\Response(\n     *         response=200,\n     *         description="Dashboard overview."\n     *     ),\n     *     @SWG\\Response(\n     *         response=401,\n     *         description="Unauthorized action.",\n     *     )\n     * )\n     */')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("index")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Request "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$request")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("response")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("json")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'result'")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'statistics'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'users'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n                        "),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'name'")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'Name'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                        "),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'email'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'user@example.com'")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'message'")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'type'")]),t._v("      "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'success'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'status'")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]),a("p",[t._v("添加下路由")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("Route::get('test', 'TestController@index');\n")])])]),a("p",[t._v("参考\n"),a("a",{attrs:{href:"https://befirstcode.blogspot.com/2017/03/integrate-swagger-in-laravel-project-l5.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Integrate Swagger API documentation with Laravel Project (L5 Swagger)"),a("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=n.exports}}]);